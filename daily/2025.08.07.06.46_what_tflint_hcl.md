# TFLintの設定ファイル(.tflint.hcl)について

## What's this file?
> [!NOTE]
> **What**
> 
> .tflint.hclファイルとは何かについて記載しています。

## Conclusion (忙しいとき向け)
> [!IMPORTANT]
> **What** : .tflint.hclとは何か
> 
> **Answer** : TFLint（Terraform Linter）の設定ファイルで、Terraformコードの静的解析ルールとプラグインを定義するHCLフォーマットのファイル

## 目次

<details>
<summary>目次を開く</summary>

- [TFLintとは](#tflintとは)
- [.tflint.hclの役割](#tflinthclの役割)
- [主要な設定項目](#主要な設定項目)
  - [プラグイン設定](#プラグイン設定)
  - [ルール設定](#ルール設定)
- [設定例の解説](#設定例の解説)
- [よく使われるルール](#よく使われるルール)

</details>

## TFLintとは

TFLintは、Terraformコードの静的解析ツールです。コードの問題点や改善点を検出し、より良いTerraformコードの記述を支援します。

主な機能：
- 構文エラーの検出
- 非推奨リソースの警告
- ベストプラクティスのチェック
- クラウドプロバイダー固有のルール適用

## .tflint.hclの役割

`.tflint.hcl`ファイルは、TFLintの動作を制御する設定ファイルです：

1. **プラグインの有効化**
   - AWSやGCP等のプロバイダー固有のルールセット
   - バージョン指定とソース設定

2. **ルールの有効/無効化**
   - デフォルトルールの設定変更
   - プロジェクト固有のルール適用

3. **カスタマイズ**
   - プロジェクトのコーディング規約に合わせた調整
   - 特定のルールのパラメータ設定

## 主要な設定項目

### プラグイン設定

```hcl
plugin "aws" {
  enabled = true
  version = "0.24.0"
  source  = "github.com/terraform-linters/tflint-ruleset-aws"
}
```

- `enabled`: プラグインの有効/無効
- `version`: 使用するプラグインのバージョン
- `source`: プラグインのソースリポジトリ

### ルール設定

```hcl
rule "terraform_naming_convention" {
  enabled = true
}
```

各ルールには：
- `enabled`: ルールの有効/無効
- その他のルール固有のパラメータ

## 設定例の解説

プロジェクトの`.tflint.hcl`の主要な設定：

1. **AWSプラグイン**
   - AWSリソース固有のルール適用
   - 無効なインスタンスタイプ検出
   - セキュリティグループの設定チェック

2. **Terraformコーディング規約**
   - 変数・出力のドキュメント化強制
   - 命名規則の統一
   - 未使用宣言の検出

3. **モジュール管理**
   - バージョン固定の強制
   - 標準構造は独自のため無効化

## よく使われるルール

- `terraform_documented_variables`: 変数のdescription必須化
- `terraform_naming_convention`: 命名規則の統一
- `terraform_unused_declarations`: 未使用リソースの検出
- `terraform_required_version`: Terraformバージョン指定の強制
- `aws_instance_invalid_type`: 無効なEC2インスタンスタイプの検出

## 関連

- [TFLint公式ドキュメント](https://github.com/terraform-linters/tflint)
- Terraform静的解析のベストプラクティス
- CI/CDパイプラインでのTFLint活用